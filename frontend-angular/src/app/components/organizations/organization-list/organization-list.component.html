<div class="organizations-container">
  <div class="organizations-header">
    <h1>Organizaciones</h1>
    <p>Gestiona y explora todas las organizaciones disponibles</p>
  </div>

  <div *ngIf="showSuccessMessage" class="success-message">
    {{ successMessage }}
  </div>

  <div class="actions-header">
    <button *ngIf="canCreate$ | async" class="btn-primary" (click)="createOrganization()">
      <span class="material-icons">add</span>
      Nueva Organización
    </button>
  </div>

  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando organizaciones...</p>
  </div>

  <div *ngIf="!loading" class="organizations-grid">
    <div *ngFor="let org of organizations" 
         class="organization-card" 
         (click)="viewOrganization(org.nit)">
      
      <div class="organization-logo-large">
        <img [src]="org.logoUrl || 'assets/default-organization.png'" 
             [alt]="org.nombre"
             (error)="org.logoUrl = 'assets/default-organization.png'">
      </div>

      <div class="organization-info-simple">
        <h3 class="organization-name">{{ org.nombre }}</h3>
      </div>

      <div class="organization-actions">
        <button *ngIf="canEdit$ | async"
                class="btn-icon edit-btn" 
                (click)="editOrganization($event, org.nit)"
                title="Editar organización">
          <span class="material-icons">edit</span>
        </button>
        
        <button *ngIf="canDelete$ | async"
                class="btn-icon delete-btn" 
                (click)="deleteOrganization($event, org.nit, org.nombre)"
                title="Eliminar organización">
          <span class="material-icons">delete</span>
        </button>
        
        <button class="btn-primary donate-btn" 
                (click)="donateOrganization($event, org)"
                title="Donar a la organización">
          <span class="material-icons">favorite</span>
          Donar
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && organizations.length === 0" class="empty-state">
    <span class="material-icons">business</span>
    <h3>No hay organizaciones</h3>
    <p>Comienza creando la primera organización</p>
    <button *ngIf="canCreate$ | async" class="btn-primary" (click)="createOrganization()">
      Crear Organización
    </button>
  </div>

  <!-- Modal de Donación -->
  <div *ngIf="showDonationModal && selectedOrganization" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Realizar Donación</h2>
        <button class="close-btn" (click)="closeDonationModal()">
          <span class="material-icons">close</span>
        </button>
      </div>
      <div class="modal-body">
        <app-donation-form 
          [organization]="selectedOrganization"
          (donationSuccess)="onDonationSuccess()"
          (cancel)="closeDonationModal()">
        </app-donation-form>
      </div>
    </div>
  </div>
</div>